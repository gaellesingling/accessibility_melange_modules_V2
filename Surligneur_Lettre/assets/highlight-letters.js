jQuery(document).ready(function(e){const t=e("#hl-panel"),o=e("#hl-handle"),n=e("#hl-apply"),i=e("#hl-clear"),s=e("#hl-letters-input"),l=e("#hl-color-input"),a=e("#hl-variants-toggle"),c="highlightLettersSettings_v8",r={a:"aàâä",e:"eéèêë",i:"iîï",o:"oôö",u:"uùûü",c:"cç",A:"AÀÂÄ",E:"EÉÈÊË",I:"IÎÏ",O:"OÔÖ",U:"UÙÛÜ",C:"CÇ"};function d(){e("span.hl-highlighted-char").each(function(){const e=this.parentNode;e&&(e.replaceChild(document.createTextNode(this.textContent),this),e.normalize())})}function h(t,o){d();let n=t;if(n&&o){if(a.is(":checked")){const e=new Set;for(const o of t)if(r[o])for(const t of r[o])e.add(t);else e.add(o);n=Array.from(e).join("")}const i=new RegExp("(["+n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"])","gi");e("body").find("*").addBack().contents().each(function(){if(3===this.nodeType&&0===e(this).closest("#hl-panel").length){const t=this.nodeValue;if(i.test(t)){const e=document.createDocumentFragment(),n=t.split(i);n.forEach(t=>{t&&(i.lastIndex=0,i.test(t)?function(t,n){const i=document.createElement("span");i.className="hl-highlighted-char",i.style.backgroundColor=o,i.textContent=t,e.appendChild(i)}(t,e):e.appendChild(document.createTextNode(t)))}),this.parentNode.replaceChild(e,this)}}})}}function p(e,t,o){localStorage.setItem(c,JSON.stringify({letters:e,color:t,variants:o}))}o.on("click",()=>t.toggleClass("open")),n.on("click",()=>{const e=s.val(),t=l.val(),o=a.is(":checked");h(e,t),p(e,t,o)}),i.on("click",()=>{d(),s.val("");const e=JSON.parse(localStorage.getItem(c))||{};e.letters="",localStorage.setItem(c,JSON.stringify(e))});const u=JSON.parse(localStorage.getItem(c));u&&(s.val(u.letters||""),l.val(u.color||"#a5d6a7"),a.prop("checked",!1!==u.variants),u.letters&&setTimeout(()=>h(u.letters,u.color),200))});